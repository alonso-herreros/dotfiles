- defaults:
    link:
      create: true
      relink: true
    shell:
      stderr: true

- clean: ['~']

- shell:
  - command: |
      {
          echo "# AUTO-GENERATED FILE. DO NOT EDIT."
          echo "# See '~/.dotfiles/install.conf.yaml' ."
          cat config/zsh-abbr/user-abbreviations.base
          scripts/utils/abbr-parse config/shell/alias.sh
          scripts/utils/abbr-parse -m git config/git/alias
      } > "${ABBR_USER_ABBREVIATIONS_FILE:?}"
    description: Adding zsh abbreviations
    quiet: true

- create:
    - $XDG_STATE_HOME/clipse


- link:
    ~/.bashrc: config/bash/bashrc
    ~/.zshrc: config/zsh/.zshrc
    # ~/.vim: vim
    ~/.vimrc: config/vim/vimrc
    ~/.screenrc: config/screen/screenrc

    ~/.config/git: config/git
    ~/.config/tmux: config/tmux
    ~/.config/synth-shell: config/synth-shell
    ~/.config/kitty: config/kitty
    ~/.config/hypr: config/hypr
    ~/.config/waybar: config/waybar
    ~/.config/fusuma: config/fusuma
    ~/.config/gh: config/gh
    ~/.config/xdg-desktop-portal: config/xdg-desktop-portal
    ~/.config/xdg-desktop-portal-termfilechooser: config/xdg-desktop-portal-termfilechooser
    ~/.config/cura: config/cura
    ~/.config/fuzzel: config/fuzzel
    ~/.config/dunst: config/dunst
    ~/.config/yazi: config/yazi
    ~/.config/clipse: config/clipse
    ~/.config/shell: config/shell
    ~/.config/zsh: config/zsh
    ~/.config/sc-im: config/sc-im
    ~/.config/X11: config/X11
    ~/.config/uwsm: config/uwsm
    ~/.config/winapps: config/winapps
    ~/.config/zsh-abbr: config/zsh-abbr

    # I wish this fucker kept its history out of the config directory
    ~/.config/qalculate/qalc.cfg: config/qalculate/qalc.cfg
    # ... and its definitions, which I want to track, IN the config directory!
    ~/.local/share/qalculate/definitions: config/qalculate/definitions

    ~/.vim/UltiSnips: config/vim/UltiSnips
    ~/.vim/coc-settings.json: config/vim/coc-settings.json
    ~/.vim/after/ftplugin: config/vim/after/ftplugin

    ~/.config/libinput-gestures.conf: config/libinput-gestures.conf
    ~/.config/locale.conf: config/locale/locale.conf
    ~/.config/mimeapps.list: config/mimeapps.list
    ~/.config/batsignal: config/batsignal
    ~/.config/kwalletrc: config/kwalletrc
    ~/.config/lesskey: config/lesskey

    ~/.config/oh-my-zsh: config/oh-my-zsh # Powerlevel10k in custom themes
    ~/.config/p10k.zsh: config/p10k/config.zsh

    # App flags
    ~/.config/:
      glob: true
      path: config/app-flags/*.conf

    # Okular stores the actual config in a rather peculiar place
    ~/.local/share/kxmlgui5/okular: config/okular

    # Desktop Entries
    ~/.local/share/applications/:
      glob: true
      path: local/share/applications/*.desktop

    # Oh My Zsh included!
    ~/.scripts: scripts

    # Warning: this is a bunch of files added to path!
    ~/.local/bin/:
      glob: True
      path: scripts/.to-path/**

    ~/.ssh/config: private/ssh/config

- shell:
  - [git submodule update --init --recursive --remote .dotbot config scripts local sys, Installing submodules]
  - [ya pkg upgrade, Updating yazi packages]
